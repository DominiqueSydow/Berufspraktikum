import pandas
import numpy as np

df = pandas.DataFrame({'A' : ['foo', 'bar', 'foo', 'bar', 'foo', 'bar', 'foo', 'foo'], 'B' : ['one', 'one', 'two', 'three', 'two', 'two', 'one', 'three'], 'C' : range(8), 'D' : range(10, 18)})

grouped = df.groupby("A")

print grouped.median()

df['Cmedians'] = df.groupby('A')['C'].transform(np.median)
df['Dmedians'] = df.groupby('A')['D'].transform(np.median)

print df

[(9, 1), (1, 2), (2, 3), (1, 4), (1, 5), (1, 6), (5, 7), (1, 8), (5, 9), (5, 10), (1, 11), (1, 12), (1, 13), (1, 14), (0, 15), (1, 16), (0, 17), (1, 18), (0, 19), (0, 20), (0, 21), (4, 22), (3, 23), (8, 24), (6, 25), (1, 26), (1, 27), (1, 28), (2, 29), (1, 30), (1, 31), (1, 32), (1, 33), (1, 34), (4, 35), (4, 36), (1, 37), (1, 38), (1, 39), (0, 40), (0, 41), (0, 42), (1, 43), (1, 44), (1, 45), (1, 46), (1, 47), (1, 48), (0, 49), (1, 50), (0, 51), (1, 52), (0, 53), (1, 54), (1, 55), (0, 56), (0, 57)]
[(9, 1), (2, 2), (1, 3), (1, 4), (1, 5), (1, 6), (1, 7), (1, 8), (1, 9), (1, 10), (1, 11), (1, 12), (0, 13), (0, 14), (0, 15), (0, 16), (0, 17), (0, 18), (0, 19), (0, 20), (0, 21), (4, 22), (4, 23), (2, 24), (2, 25), (2, 26), (1, 27), (1, 28), (1, 29), (1, 30), (1, 31), (1, 32), (1, 33), (1, 34), (1, 35), (1, 36), (1, 37), (1, 38), (1, 39), (0, 40), (0, 41), (0, 42), (0, 43), (0, 44), (0, 45), (0, 46), (0, 47), (0, 48), (0, 49), (0, 50), (0, 51), (0, 52), (0, 53), (0, 54), (0, 55), (0, 56), (0, 57)]
